# Helm Chart for CVELens Web Application!

This Helm chart deploys the CVE Processor application, which downloads CVE (Common Vulnerabilities and Exposures) data, processes it, and publishes it to a Kafka topic.

## Prerequisites

Before deploying this Helm chart, ensure you have the following:

- Kubernetes cluster (version 1.25+)
- Helm (version 3.0+)
- Access to the Kafka cluster deployed on the Kubernetes cluster
- Namespaces created for the deployment

## Installation

To install the chart with the release name `csye7125`:

```bash
helm install csye7125 csye7125.tar.gz -n ns1
```

This will deploy the CVE Processor web application and its PostgreSQL database in the `ns1` namespace.

## Configuration

The following table lists the configurable parameters of the `helm-webapp-cve-processor` chart and their default values.

| Parameter                      | Description                                 | Default                                      |
|--------------------------------|---------------------------------------------|----------------------------------------------|
| `replicaCount`                 | Number of processor replicas                | 1                                            |
| `namespace`                    | Namespace to deploy the processor           | ns1                                          |
| `name`                         | Name of the deployment                      | csye7125                                     |
| `app.image`                    | Processor application image                 | chlokesh1306/cve-processor          |
| `app.tag`                      | Processor application image tag             | latest                                       |
| `app.pullPolicy`               | Image pull policy                           | Always                                       |
| `app.env`                      | Environment variables for the processor app | See `values.yaml` for defaults               |
| `imagePullSecrets.name`        | Name of the image pull secret               | dockerhub                                    |
| `imagePullSecrets.dockerconfigjson` | Base64 encoded Docker config JSON         | See `values.yaml` for defaults               |

Specify each parameter using the `--set key=value[,key=value]` argument to `helm install`. For example:

```bash
helm install csye7125 csye7125.tar.gz --set replicaCount=2 -n ns1
```

Alternatively, a YAML file that specifies the values for the parameters can be provided while installing the chart. For example:

```bash
helm install csye7125 csye7125.tar.gz -f values.yaml -n ns1
```

## Architecture

This Helm chart deploys the following components:

- CVE Processor application via the Job resource

The processor application downloads the latest CVE data, processes all JSON files in all directories, and publishes the processed data to a Kafka topic named `cve`.

## Upgrading

To upgrade the chart:

```bash
helm upgrade csye7125 csye7125.tar.gz -f values.yaml -n ns1
```

## Uninstalling

To uninstall/delete the csye7125 deployment:

```bash
helm delete csye7125 -n ns1
```
This command removes all the Kubernetes components associated with the chart and deletes the release.


## Troubleshooting

If you encounter issues:

Check the status of the pods:

```bash
kubectl get pods -n ns1
```

View the logs of the processor application:

```bash
kubectl logs -f <processor-pod-name> -n ns1
```

Verify Kafka connectivity:

```bash
kubectl exec -it <processor-pod-name> -n ns2 -- /bin/sh
# Inside the pod
nc -zv <kafka-broker-address> 9092
```